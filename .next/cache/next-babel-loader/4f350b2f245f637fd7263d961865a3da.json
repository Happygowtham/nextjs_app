{"ast":null,"code":"const jwt = require('jsonwebtoken');\n\nconst jwtSecret = 'SUPERSECRETE20220';\nexport default ((req, res) => {\n  if (req.method === 'GET') {\n    if (!('token' in req.cookies)) {\n      res.status(401).json({\n        message: 'Unable to auth'\n      });\n      return;\n    }\n\n    let decoded;\n    const token = req.cookies.token;\n\n    if (token) {\n      try {\n        decoded = jwt.verify(token, jwtSecret);\n      } catch (e) {\n        console.error(e);\n      }\n    }\n\n    if (decoded) {\n      res.json(decoded);\n      return;\n    } else {\n      res.status(401).json({\n        message: 'Unable to auth'\n      });\n    }\n  }\n});","map":null,"metadata":{},"sourceType":"module"}